/** Canva - jQuery Plugin for inject canvas text into html text
 * @external Canva
 * @version 1.0.2
 * @since 28.12.2018
 */
!function(t){"use strict";var e,n={name:"Canva",version:"1.0.2",data:{setting:"setting",general:"general",flag:"flag"},attr:{trigger:"data-canva",content:"data-canva-content",method:"data-canva-method",rtl:"data-canva-rtl"}},r={content:"Q2FudmE=",decode:"base64",method:"block",rtl:!1,event:{},canvas:function(t,e,n){}},o={context:null,method:"init",type:"init"},i={$window:t(window),pixelRatio:(e=document.createElement("canvas").getContext("2d"),(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)+1)},a={};function c(t){return 1!==window.devicePixelRatio?t*i.pixelRatio:t}function s(t){return Object.prototype.toString.call(t).replace(/^\[object (.+)\]$/,"$1").toLowerCase()}function u(t,e){return e.includes(s(t))}function l(){return t.extend.apply(null,d([!0,{}],arguments))}function d(){if(!arguments.length)return[];for(var e=[],n=0;n<arguments.length;n++)e=t.merge(e,arguments[n]);return e}function f(t,e){var n={};return n[t]=e,n}function g(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function v(t){return{set:function(e,r,o){var i=this.get()||{},a=l(i[e]||{},r);return o&&u(o,"function")&&o.call(t,a,e),t.data(n.name,l(i,f(e,a))),a},get:function(e){var r=t.data(n.name);return e?r&&r[e]?r[e]:null:r||null}}}function h(t,e){if(u(t,"string")&&u(e,"string"))switch(e.toLowerCase()){case"base64":return decodeURIComponent(escape(window.atob(t)))}return p("Decode mode "+e+" don't support. Plugin return source content",{content:t,mode:e}),t}function p(t){var e,r;console.error.apply(null,d(["["+n.name+"]",t],arguments.length>1?(e=arguments,r=1,Array.prototype.slice.call(e,void 0===r?0:r)):[]))}a.init=function(e,a,d){var m=v(e).set(n.data.setting,l(r,a),function(t){t.decode=t.decode.toLowerCase()});if(!u(m.content,"string")||u(m.content,"string")&&!m.content.length)return p("Content is empty",{content:m.content}),e;var x=v(e).set(n.data.general,l(o,d),function(t){t.content=function(){try{return h(m.content,m.decode)}catch(t){return p("Fail decode content data. Content returned without decoding",{content:m.content,decode:m.decode},t),m.content}}(),t.$env=e.parent(),t.offset=5}),w=v(e).set(n.data.flag,{resize:!1});function y(n){var r;if(x.context.innerHTML="",x.style=function(t,e){var n={},r=s(e);if(["array","string"].includes(r)&&e.length){"string"===r&&(e=[e]);for(var o=0;o<e.length;o++)if(u(e[o],"string")){var i=t.css(e[o]);u(i,"string")&&(n[(a=e[o],a.replace(/-([a-z])/g,function(t,e){return e.toUpperCase()}))]=i)}}var a;return n}(e,["font","color","line-height","font-size"]),x.computed=function(e,n){var r=t("<span/>",f("text",function t(e){var n=e.split("").sort(function(){return Math.random()-.5}).join("");if(n===e)return t(e);return n}(n)));e.append(r);var o={width:r.width(),height:r.height()};return r.remove(),o}(e,x.content),x.$canvas=e.find("canvas").length?t("canvas",x.context):(r=t("<canvas/>"),e.append(r),r),x.canvas=x.$canvas.get(0),x.canvas.width=c(x.computed.width),x.canvas.height=c(x.computed.height),x.canvas.style.width=x.computed.width+"px",x.canvas.style.height=x.computed.height+"px",x.canvas.style.transform="translateY("+x.offset+"px)",x.ctx=x.canvas.getContext("2d"),x.ctx.font=x.style.font,x.ctx.fillStyle=x.style.color,x.ctx.textBaseline="alphabetic",1!==window.devicePixelRatio&&x.ctx.setTransform(i.pixelRatio,0,0,i.pixelRatio,0,0),u(m.canvas,"function")&&m.canvas.call(x.ctx,{style:x.style,computed:x.computed},x.$canvas,x.ctx),!function(t){for(var e in t)if(g(t,e))return!1;return!0}(m.event))for(var o in m.event)u(m.event[o],"function")&&x.$canvas.on(o,function(t){m.event[o].call(this,t,{style:x.style,computed:x.computed},x.ctx)});var a=m.rtl?x.computed.width:0;switch(m.method){case"inline":x.ctx.fillText(x.content,a,x.computed.height-x.offset);break;case"block":!function(t,e,n){for(var r=t.split(" "),o="",i=0;i<r.length;i++){var a=o+r[i]+" ";x.ctx.measureText(a).width>x.computed.width&&i>0?(x.ctx.fillText(o,e,n),o=r[i]+" ",n+=parseInt(x.style.lineHeight,10)):o=a}x.ctx.fillText(o,e,n),x.ctx}(x.content,a,parseInt(x.style.fontSize,10)-2)}return x.ctx}return y("init"),!1===w.resize&&(i.$window.on("resize",function(){y("resize")}),w=v(e).set(n.data.flag,{resize:!0})),function(t,e){if(u(e,"array")&&e.length)for(var n=0;n<e.length;n++)u(e[n],"string")&&t.removeAttr(e[n]);return t}(e,function(t){var e=[];for(var n in t)g(t,n)&&e.push(t[n]);return e}(function(t,e){var n={};for(var r in t)g(t,r)&&!e.includes(r)&&(n[r]=t[r]);return n}(n.attr,["trigger"])))},t[n.name]={content:function(t){var e=u(t,"string");return!e||e&&!t.length?t:{decode:function(e){return void 0===e&&(e="base64"),h(t,e)},encode:function(e){if(void 0===e&&(e="base64"),u(e,"string"))switch(e.toLowerCase()){case"base64":return window.btoa(unescape(encodeURIComponent(t)))}return t}}}},t.fn[n.name]=function(e){if(u(e,["object","string"])||!e){var n="string"==typeof e?{content:e}:e;return t.each(this,function(){a.init(t(this),n,{context:this,method:"init",type:"init"})})}},t("["+n.attr.trigger+"]").length&&t.each(t("["+n.attr.trigger+"]"),function(){var e={content:t(this).attr(n.attr.content),method:t(this).attr(n.attr.method),rtl:t(this).attr(n.attr.rtl)};for(var r in e)g(e,r)&&(e[r]&&u(e[r],"string")||delete e[r]);t(this)[n.name](e)})}(jQuery);